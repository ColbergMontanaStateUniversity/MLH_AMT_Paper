function [FluxData] = trim_flux_tower_data(FluxData)
% TRIM_FLUX_TOWER_DATA trims the FluxData structure to a fixed time window

% Keeps only data between time = -2 hours and time = 26 hours.

% INPUT:
%   FluxData - Structure containing concatenated flux tower measurements

% OUTPUT:
%   FluxData - Structure with time window trimmed to -2 <= time <= 26 hours

%% Find indices corresponding to desired time window
indLow  = find(FluxData.time >= -2, 1, 'first'); % first valid time index
indHigh = find(FluxData.time <= 26, 1, 'last');  % last valid time index

%% Trim the time field
FluxData.time = FluxData.time(indLow:indHigh);

%% List of fields to trim
fieldsToTrim = {
    'wTc4mT0','wH2o4mT0','tc4mT0','p4mT0','h2o4mT0',...
    'wTc4mT2','wH2o4mT2','tc4mT2','p4mT2','h2o4mT2',...
    'wTc4mT5','wH2o4mT5','tc4mT5','p4mT5','h2o4mT5',...
    'wTc4mT8','wH2o4mT8','tc4mT8','p4mT8','h2o4mT8',...
    'wTc4mT11','wH2o4mT11','tc4mT11','p4mT11','h2o4mT11',...
    'wTc4mT14','wH2o4mT14','tc4mT14','p4mT14','h2o4mT14',...
    'wTc4mT17','wH2o4mT17','tc4mT17','p4mT17','h2o4mT17',...
    'wTc4mT20','wH2o4mT20','tc4mT20','p4mT20','h2o4mT20',...
    'wTc4mT23','wH2o4mT23','tc4mT23','p4mT23','h2o4mT23',...
    'wTc4mT26','wH2o4mT26','tc4mT26','p4mT26','h2o4mT26',...
    'wTc4mT29','wH2o4mT29','tc4mT29','p4mT29','h2o4mT29',...
    'wTc4mT32','wH2o4mT32','tc4mT32','p4mT32','h2o4mT32',...
    'wTc4mT35','wH2o4mT35','tc4mT35','p4mT35','h2o4mT35',...
    'wTc4mT38','wH2o4mT38','tc4mT38','p4mT38','h2o4mT38',...
    'wTc4mT41','wH2o4mT41','tc4mT41','p4mT41','h2o4mT41',...
    'wTc4mT44','wH2o4mT44','tc4mT44','p4mT44','h2o4mT44',...
    'wTc4mT47','wH2o4mT47','tc4mT47','p4mT47','h2o4mT47'};

%% Trim each field
for i = 1:length(fieldsToTrim)
    FluxData.(fieldsToTrim{i}) = FluxData.(fieldsToTrim{i})(indLow:indHigh);
end

end
